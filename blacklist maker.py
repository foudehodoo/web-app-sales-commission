import pandas as pd
from datetime import datetime
import io


def generate_complete_blacklist():
    # 1. ุฏุงุฏูโูุง ุฎุงุต ูุจู (ุจุงูฺฉโูุง ู ููุงุฑุฏ ูููุช)
    # ุชุงุฑุฎโูุง ุฑุง ุฏููุงู ุทุจู ุฏุฑุฎูุงุณุช ุดูุง ูฺฏู ุฏุงุดุชู
    special_data = [
        {"CustomerCode": "",
            "CustomerName": "ุจุงูู ุชูุณุนู ุตุงุฏุฑุงุช 0100034098005 ( ุญุณุงุจ ูุฑุถ ุงูุญุณูู)", "Date Added": "2026-01-21 12:18:56"},
        {"CustomerCode": "", "CustomerName": "ุจุงูู ููู 0109979148009",
            "Date Added": "2026-01-21 12:18:58"},
        {"CustomerCode": "", "CustomerName": "ุจุงูู ููู 0366987498004",
            "Date Added": "2026-01-21 12:19:01"},
        {"CustomerCode": "",
            "CustomerName": "ุณูู ุดูุฑ ููุดู ูุฒุงุฑ ุจูุถุงุก(ุญุณููุนูู ูพูุด ุฑู)", "Date Added": "2026-01-21 12:19:03"},
        {"CustomerCode": "", "CustomerName": "ูููุช",
            "Date Added": "2026-01-21 12:19:05"},
    ]

    # 2. ูุณุช ุฌุฏุฏ ูุดุชุฑุงู (ฺฉุฏ ู ูุงู)
    raw_text_list = """
21801	ูุญูุฏ ููุตูุฏู
21797	ูุตุทูู ูุญูุฑู ุญุจูุจ ุขุจุงุฏ
20002	ุดูุฑ ู ฺฏูุดุช ููุฏู ุณูพุงูุงู
21394	ุขุฑูู ุฏุงููุงุฑุงู ููุซุฑ
20915	ุงูุฏู ูุญูุฑุงู ุฒูุณุช ูุนุงู
20938	ฺฏูุชุง ุฏุงู ุณููุฏ
20962	ูุญูุฏ ุนูู ุทูุจู
20411	ุบูุงูุฑุถุง ฺูููุงูู
20310	ุญููุฏ ุฑุถุง ุญูุงุฑู
22341	ุขูุฑูู ุชุฌุงุฑุช ูพุงููุฒ
22242	ุขููู ุชุฌุงุฑุช ุฑุฎุดุงู
21178	ุญุณูู ููุฑุจุฎุด
22229	ุนูุงูุช ุงููู ูุณูุจู
22227	ูุฑูุงู ูุงูุด ุงุณูพุงุฏุงูุง ( ุขุฑูุงูู )
21287	ุญููุฏ  ูพูุณุชู
22668	ุนููุฑุถุง ูุฑููู ูพูุฑ
21838	ุชูููุฏ ุฏุงููพุฑูุฑุงู ูฺฏูู ุงุณูพุงุฏุงูุง
22240	ุฑุถุง ูุงุนู ุงุตููุงูู
21719	ุขุฑุงุฒ ุฏุงู ูุจูุฑ
20193	ูุฌุชูุน ุตูุงูุน ุบุฐุงูู ุจููพูุฏุฑ ุงุตููุงู
21796	ูุญูุฏ ุฒุฑุงุนุชู
21767	ูุญูุฏ ุนูู ุดูุฎู ุฎูุฑุงุณฺฏุงูู
21834	ุนุจุงุณุนูู ุนุณฺฏุฑู (ุงุฑู ูพุดุช)
23015	ุฑุณูู ุขูุง ุจุงุจุงูู
21777	ุณูุฏ ุฌูุงุฏ ุงููุฑู
21682	ุณุนูุฏ ุถูุงูู
20046	ููุงู ุฏุงู ูพูุดุฑู ูพุงุฑุณ
21449	ุฑุถุง ุฌูุงูู ูุฑุฏ
21500	ููุณุชุงู ูููุง ฺฏุณุชุฑ ุจูุนูู
21726	ูพูุดุฑู  ุฏุงู ูุงุฑู
23181	ุฏุฑุณุง ุฏุงูู
21515	ูุฑุชุถู ุชุฑุงุจู( ููุฏุงู)
21540	ูุญูุฏ ุชูู ุณูุทุงูู(ููุฏุงู)
21746	ุงููุฏ ูพูุฑูุนูุชู (ููุฏุงู)
21901	ุญุณูู ุณูุทุงูู (ููุฏุงู)
21902	ุฏุงููุฏ ูุฌูู (ููุฏุงู )
21904	ุณูุณู ุฑุณุชฺฏุงุฑ (ููุฏุงู)
21980	ุขุฑุด ฺูุงุฑ ุฏููู(ููุฏุงู)
21981	ุฏุงุฑูุฎุงูู ุฏุงููพุฒุดูู ููููู(ููุฏุงู)
21982	ูุญูุฏ ุฌุนูุฑ ูุงุธูู(ููุฏุงู)
21983	ูุฑููุด ูุฎุงุฑูู (ููุฏุงู)
21984	ุนุจุฏุงูุญููุฏ ูุฏุฑุชู (ููุฏุงู)
22483	ุฏูุชุฑ ุณูพูุฑู (ููุฏุงู)
22485	ููุซู ุขุฒุงุฏู (ููุฏุงู )
22486	ุณุฌุงุฏ ุฒูุฏูู (ููุฏุงู)
22555	ุงุชุญุงุฏูู ููุฏุงู
22573	ุฏูุชุฑ ุฒูฺฏูู (ููุฏุงู)
22574	ูุญูุฏ ุนุจุงุณู (ููุฏุงู)
22575	ูุญูุฏ ุฎุฑู ุงุจุงุฏู (ููุฏุงู)
22657	ุงููุฑ ูุฌูู(ููุฏุงู)
22768	ุจูุฒุงุฏ ุณูููุงูู (ููุฏุงู)
23126	ุนูู ุงุตุบุฑ ุนุจุงุณู (ููุฏุงู)
23176	ุฏูุชุฑ ุตูุฑู (ููุฏุงู)
23177	ุฏุงุฑูุฎุงูู ุฏุงููพุฒุดูู ุฏูุชุฑ ุขุฎููุฏู (ููุฏุงู)
23178	ุฏูุชุฑ ฺุงูู (ููุฏุงู)
23179	ุฏูุชุฑ ุตุฏุฑุง (ููุฏุงู)
23180	ุฏูุชุฑ ุฌูุช ุฎูุงู (ููุฏุงู)
20079	ุงุจูุงููุถู ุณูุทุงูู
20047	ุขุฑูุงู ูุจู ููุด ุฌูุงู
23703	ุดุฑูุช ุชุนุงููู ูุฑุบุฏุงุฑุงู ุดูุฑุถุง
    """

    # ูพุฑุฏุงุฒุด ูุชู ูุณุช ูุดุชุฑุงู
    customers_list = []
    current_time = datetime.now().strftime("%Y-%m-%d %H:%M:%S")

    for line in raw_text_list.strip().splitlines():
        line = line.strip()
        if not line:
            continue

        # ุฌุฏุง ฺฉุฑุฏู ฺฉุฏ ู ูุงู (ูุฑุถ ุจุฑ ุงู ุงุณุช ฺฉู ุจุง ูุงุตูู ุง ุชุจ ุฌุฏุง ุดุฏูโุงูุฏ)
        # ุงุจุชุฏุง ุณุน ูโฺฉูู ุจุง ุชุจ ุฌุฏุง ฺฉูู
        parts = line.split('\t')
        if len(parts) < 2:
            # ุงฺฏุฑ ุชุจ ูุจูุฏุ ุจุง ุงููู ูุงุตูู ุณูุฏ ุฌุฏุง ฺฉู
            parts = line.split(maxsplit=1)

        if len(parts) >= 2:
            code = parts[0].strip()
            name = parts[1].strip()
            customers_list.append({
                "CustomerCode": code,
                "CustomerName": name,
                "Date Added": current_time
            })

    # ุชุฑฺฉุจ ููู ุฏุงุฏูโูุง
    final_data = special_data + customers_list

    # ุณุงุฎุช ุฏุชุงูุฑู
    df = pd.DataFrame(final_data)

    # ุฐุฎุฑู ูุงู
    file_name = "blacklist.xlsx"
    try:
        df.to_excel(file_name, index=False)
        print(f"โ ูุงู '{file_name}' ุจุง ููููุช ุณุงุฎุชู ุดุฏ.")
        print(f"๐ ูุฌููุน ุฑุฏูโูุง: {len(df)}")
        print("-" * 30)
        # ููุงุด ฺูุฏ ุฑุฏู ุงูู ู ุขุฎุฑ ุจุฑุง ุงุทููุงู
        print("5 ุฑุฏู ุงูู (ุฏุงุฏูโูุง ุจุงูฺฉ):")
        print(df.head(5)[["CustomerCode", "CustomerName"]])
        print("\n5 ุฑุฏู ุขุฎุฑ (ุฏุงุฏูโูุง ูุชู):")
        print(df.tail(5)[["CustomerCode", "CustomerName"]])

    except Exception as e:
        print(f"โ ุฎุทุง ุฏุฑ ุฐุฎุฑู ูุงู: {e}")


if __name__ == "__main__":
    generate_complete_blacklist()
